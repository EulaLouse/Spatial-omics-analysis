This repository contains the code needed to reproduce all results and plots in the paper "Spatially resolved multi-omic approach reveals metabolic dysregulation and a disease-associated oligodendrocyte subtype in Parkinsonâ€™s disease", Zhu Z.T. et al. Code snippets are separated into files mirroring the organization of figures in the manuscript.

Spatial transcriptome.R: This code uses the Seurat package to process spatial transcriptomics data from 4 samples. It begins by loading and merging the data to create a Seurat object, followed by quality control (checking UMI counts, gene numbers, and mitochondrial gene proportions). The data is then normalized using SCTransform, with batch effects corrected via MNN integration before clustering analysis (visualized with t-SNE). Finally, it identifies cluster-specific marker genes and performs differential expression analysis (comparing samples using the MAST method).

Spatial metabolomics.R: This code is primarily used for spatial metabolomics data analysis, encompassing mass spectrometry imaging data processing and visualization functions. The code provides a comprehensive analytical pipeline from raw data reading (imzML format), data preprocessing (smoothing, peak detection, alignment), image generation to differential analysis. It supports multiple visualization methods (scatter plots, heatmaps, volcano plots, etc.) and includes metabolite differential analysis and multi-group comparison functions, designed for analyzing and visualizing spatial metabolomics data.

Mapping datasets.R: This R code implements a single-cell RNA sequencing data analysis pipeline for gene ID conversion and integration. It first uses biomaRt to perform cross-species gene ID mapping between mouse and human genes, then aggregates multi-layer counts data to create a Seurat object. The pipeline subsequently performs data normalization and PCA dimensionality reduction for preprocessing, and finally conducts cell type prediction using reference datasets with UMAP visualization to display the analytical results.
